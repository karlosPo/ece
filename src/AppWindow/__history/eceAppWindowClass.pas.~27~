unit eceAppWindowClass;

interface

uses
  Windows,
  Messages,
  eceAppWindowI,
  eceAppWindowTypes,
  zeWndControl;

type
  TeceAppWindowClass = class(TzeWndControl, IeceAppWindow)
  private
    function QueryInterface(const IID: TGUID; out Obj): HResult; stdcall;
    function _AddRef: Integer; stdcall;
    function _Release: Integer; stdcall;
  protected
    function GetHwnd : HWND; override;
  public
    constructor Create;

    {Interface}
    Procedure About;
  end;

implementation

{ TeceAppWindowClass }

procedure TeceAppWindowClass.About;
begin
  MessageBox(Handle, 'Easy Code Editor v0.1', 'About ece', 0)
end;

constructor TeceAppWindowClass.Create;
begin
  inherited;
end;

function TeceAppWindowClass.GetHwnd: HWND;
begin
    Result := CreateWindowEx(WS_EX_CLIENTEDGE,
    wc_eceAppWindow, '[] - ece', WS_OVERLAPPEDWINDOW or WS_CLIPSIBLINGS,
    CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT,
    0, 0, HInstance, Pointer(self));
end;

function TeceAppWindowClass.QueryInterface(const IID: TGUID; out Obj): HResult;
begin

end;

function TeceAppWindowClass._AddRef: Integer;
begin

end;

function TeceAppWindowClass._Release: Integer;
begin

end;

end.
