library autospace;

uses
    windows,
    ComObj,
    ActiveX,
    IEce in '.\..\Iece.pas';

type
  TPlugin = Class(TInterfacedObject, IEcePlugin)
  private
    FMsSc : OleVariant;
  public
    constructor Create;
    Destructor Destroy; override;
    function Load(App : IEceApplication) : boolean; safecall;
  End;

function GetPlugin : IEcePlugin; stdcall;
begin
  Result := TPlugin.Create;
end;

exports
	GetPlugin;

{ TPlugin }

constructor TPlugin.Create;
begin
  inherited;
  CoInitializeEx(nil, 0);
end;

destructor TPlugin.Destroy;
begin
  CoUninitialize();
  inherited;
end;

function TPlugin.Load(App: IEceApplication): boolean;
begin

end;

begin

end.
