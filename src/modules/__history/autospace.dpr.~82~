library autospace;

uses
    windows,
    IEce in '.\..\Iece.pas';

type
  TPlugin = Class(TInterfacedObject, IEcePlugin)
  private
    FMsSc : OleVariant;
  public
    constructor Create;
    Destructor Destroy; override;
    function Load(App : IEceApplication) : boolean; safecall;
  End;

function GetPlugin : IEcePlugin; stdcall;
begin
  Result := TPlugin.Create;
end;

exports
	GetPlugin;

{ TPlugin }

constructor TPlugin.Create;
begin
  inherited;
end;

destructor TPlugin.Destroy;
begin

  inherited;
end;

function TPlugin.Load(App: IEceApplication): boolean;
var
  doc : IEceDocument;
  editor : IEceEditor;
begin
  //Тут повесим события на некоторые объекты
  App._GetDocuments(0, doc);
  editor := IEceEditor(doc);
  editor._AddLine._SetText('Привет мир!');
end;

begin

end.
